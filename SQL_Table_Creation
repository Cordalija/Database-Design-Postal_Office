CREATE TABLE `CUSTOMER` (
`Cus_ID`VARCHAR(6) NOT NULL,
`Cus_fname`VARCHARNOT NULL,
`Cus_lname`VARCHARNOT NULL,
`Cus_DOB`DATE,
`Cus_sex`CHAR(1) CHECK(Cus_sex in ( "M" , "F" )) COLLATE NOCASE,
`Cus_streetaddress`VARCHAR,
`Cus_city`VARCHAR,
`Cus_state`VARCHAR(2),
`Cus_ZIP`INTEGER CHECK (Cus_ZIP >= 501 AND Cus_ZIP < 100000),
`Cus_phonenumber`INTEGER CHECK (Cus_phonenumber >= 0 AND Cus_phonenumber < 10000000000),
`Cus_stopID` VARCHAR(6),
PRIMARY KEY(`Cus_ID`),
FOREIGN KEY(Cus_stopID) REFERENCES DELIVERY_STOP(Stop_ID) ON UPDATE CASCADE ON DELETE SET NULL
);


CREATE TABLE `DELIVERY_STOP` (
`Stop_ID`VARCHAR(6) NOT NULL,
PRIMARY KEY(`Stop_ID`)
);


CREATE TABLE `DRIVE_TIME` (
`DT_driverID`VARCHAR(6) NOT NULL,
`DT_truckID`VARCHAR(6) NOT NULL,
`DT_startdate_time`DATE NOT NULL,
`DT_enddate_time`DATE CHECK (DT_enddate_time > DT_startdate_time),
PRIMARY KEY(`DT_driverID`,`DT_truckID`,`DT_startdate_time`),
FOREIGN KEY(DT_driverID) REFERENCES EMPLOYEE(Emp_ID) ON UPDATE CASCADE ON DELETE RESTRICT,
FOREIGN KEY(DT_truckID) REFERENCES TRUCK(Truck_ID) ON UPDATE CASCADE ON DELETE RESTRICT
);


CREATE TABLE `EMPLOYEE` (
`Emp_ID`VARCHAR(6) NOT NULL,
`Emp_fname`VARCHAR NOT NULL,
`Emp_lname`VARCHAR NOT NULL,
`Emp_DOB`DATE NOT NULL,
`Emp_sex`CHAR(1) CHECK(EMP_sex in ( "M" , "F" )) COLLATE NOCASE,
`Emp_streetaddress`VARCHAR,
`Emp_city`VARCHAR,
`Emp_state`VARCHAR(2),
`Emp_ZIP`INTEGER CHECK (Emp_ZIP > 501 AND Emp_ZIP < 100000),
`Emp_phonenumber`INTEGER CHECK (Emp_phonenumber >= 0 AND Emp_phonenumber < 10000000000),
`Emp_managerID`VARCHAR(6),
`Emp_postofficeID`VARCHAR(6),
PRIMARY KEY(`Emp_ID`),
FOREIGN KEY(Emp_managerID) REFERENCES EMPLOYEE(Emp_ID) ON UPDATE CASCADE ON DELETE SET NULL,
FOREIGN KEY(Emp_postofficeID) REFERENCES POST_OFFICE(PO_ID) ON UPDATE CASCADE ON DELETE SET NULL
);


CREATE TABLE `MAIL_ROUTE` (
`Route_ID`VARCHAR(6) NOT NULL,
PRIMARY KEY(`Route_ID`)
);


CREATE TABLE `PACKAGE` (
`Pack_ID`VARCHAR(6) NOT NULL,
`Pack_type`VARCHAR CHECK(Pack_type in ('Box', 'Envelope', 'Postcard')) COLLATE NOCASE,
`Pack_price`DOUBLE CHECK (Pack_price >= 0),
`Pack_weight`DOUBLE CHECK (Pack_weight >= 0) ,
`Pack_volume`DOUBLE CHECK (Pack_volume >= 0),
`Pack_senderID`VARCHAR(6),
`Pack_receiverID`VARCHAR(6),
PRIMARY KEY(`Pack_ID`),
FOREIGN KEY(Pack_senderID) REFERENCES CUSTOMER(Cus_ID) ON UPDATE CASCADE ON DELETE SET NULL,
FOREIGN KEY(Pack_receiverID) REFERENCES CUSTOMER(Cus_ID) ON UPDATE CASCADE ON DELETE SET NULL
);


CREATE TABLE `PACKAGE_ARRIVAL` (
`PA_packageID`VARCHAR(6) NOT NULL,
`PA_stopID`VARCHAR(6) NOT NULL,
`PA_arrivaldate_time`DATE NOT NULL,
PRIMARY KEY(`PA_packageID`,`PA_stopID`,`PA_arrivaldate_time`),
FOREIGN KEY(PA_packageID) REFERENCES PACKAGE(Pack_ID) ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY(PA_stopID) REFERENCES DELIVERY_STOP(Stop_ID) ON UPDATE CASCADE ON DELETE CASCADE
);


CREATE TABLE `POST_OFFICE` (
`PO_ID`VARCHAR(6) NOT NULL,
`PO_name`VARCHAR,
`PO_streetaddress`VARCHAR,
`PO_city`VARCHAR,
`PO_state`VARCHAR(2),
`PO_ZIP`INTEGER CHECK (PO_ZIP >= 501 AND PO_ZIP < 100000),
`PO_phonenumber`INTEGER CHECK (PO_phonenumber >= 0 AND PO_phonenumber < 10000000000),
`PO_stopID`VARCHAR(6),
`PO_supervisorID`VARCHAR(6),
PRIMARY KEY(`PO_ID`),
FOREIGN KEY(PO_stopID) REFERENCES DELIVERY_STOP(Stop_ID) ON UPDATE CASCADE ON DELETE RESTRICT,
FOREIGN KEY(PO_supervisorID) REFERENCES EMPLOYEE(Emp_ID) ON UPDATE CASCADE ON DELETE SET NULL
);


CREATE TABLE `STOPS_ON_ROUTE` (
`SOR_routeID`VARCHAR(6) NOT NULL,
`SOR_stopID`VARCHAR(6) NOT NULL,
PRIMARY KEY(`SOR_routeID`,`SOR_stopID`),
FOREIGN KEY(SOR_routeID) REFERENCES MAIL_ROUTE(Route_ID) ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY(SOR_stopID) REFERENCES DELIVERY_STOP(Stop_ID) ON UPDATE CASCADE ON DELETE CASCADE
);


CREATE TABLE `TRUCK` (
`Truck_ID`VARCHAR(6) NOT NULL,
`Truck_class`CHAR(1),
PRIMARY KEY(`Truck_ID`),
FOREIGN KEY(Truck_class) REFERENCES TRUCK_TYPE(Truck_type_class) ON UPDATE CASCADE ON DELETE RESTRICT
);
CREATE TABLE `TRUCK_CONTROL_PERIOD` (
`TCP_officenumber`VARCHAR(6) NOT NULL,
`TCP_truckID`VARCHAR(6) NOT NULL,
`TCP_startdate_time`DATE NOT NULL,
`TCP_enddate_time`DATE,
PRIMARY KEY(`TCP_officenumber`,`TCP_truckID`,`TCP_startdate_time`),
FOREIGN KEY(TCP_officenumber) REFERENCES POST_OFFICE(PO_ID) ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY(TCP_truckID) REFERENCES TRUCK(Truck_ID) ON UPDATE CASCADE ON DELETE CASCADE
);


CREATE TABLE `TRUCK_ROUTES_DRIVEN` (
`TRD_truckID`VARCHAR(6) NOT NULL,
`TRD_routeID`VARCHAR(6) NOT NULL,
PRIMARY KEY(`TRD_truckID`,`TRD_routeID`),
FOREIGN KEY(TRD_truckID) REFERENCES TRUCK(Truck_ID) ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY(TRD_routeID) REFERENCES ROUTE(Route_ID) ON UPDATE CASCADE ON DELETE CASCADE
);


CREATE TABLE `TRUCK_TYPE` (
`Truck_type_class`CHAR(1) NOT NULL,
`Truck_type_max_weight`INTEGER CHECK (Truck_type_max_weight > 0),
`Truck_type_max_volume`INTEGER CHECK (Truck_type_max_volume > 0),
PRIMARY KEY(`Truck_type_class`)
);
 
